# ü§ñ Smart AI Assistant - Chatbot IA

Assistant IA intelligent int√©gr√© √† SmartApp Academy‚Ñ¢, propuls√© par ChatGPT.

---

## üéØ Pr√©sentation

Le Smart AI Assistant est un chatbot conversationnel aliment√© par l'API OpenAI (GPT-4o-mini) qui permet aux utilisateurs de SmartApp Academy‚Ñ¢ d'obtenir de l'aide et des conseils personnalis√©s sur :

- üíº La cr√©ation d'entreprise
- üì± Le marketing digital
- ü§ñ L'IA appliqu√©e au business
- ‚ö° Les SaaS et Supabase
- üîÑ L'automatisation

---

## ‚ú® Fonctionnalit√©s

### Pour les utilisateurs
- üí¨ **Conversations illimit√©es** : Cr√©ez autant de conversations que n√©cessaire
- üìù **Historique complet** : Tous vos √©changes sont sauvegard√©s
- üß† **Contexte intelligent** : L'IA se souvient de la conversation (20 derniers messages)
- üîí **S√©curis√©** : Vos conversations sont priv√©es et prot√©g√©es
- ‚ö° **Temps r√©el** : R√©ponses en quelques secondes
- üé® **Interface moderne** : Design √©l√©gant et intuitif

### Pour les administrateurs
- ‚öôÔ∏è **Prompt personnalisable** : Modifiez le comportement de l'IA via l'interface admin
- üìä **Statistiques** : Suivez l'utilisation du chatbot
- üîç **Logs d√©taill√©s** : Surveillez toutes les interactions
- üí∞ **Contr√¥le des co√ªts** : Mod√®le √©conomique (gpt-4o-mini)

---

## üöÄ D√©marrage rapide

### 1. Configuration (8 minutes)

```bash
# 1. Cr√©er les tables dans Supabase
   ‚Üí Coller ai_chatbot.sql dans SQL Editor

# 2. Obtenir une cl√© OpenAI
   ‚Üí platform.openai.com/api-keys

# 3. Configurer le secret
   ‚Üí Supabase > Edge Functions > Secrets
   ‚Üí Ajouter: OPENAI_API_KEY

# 4. D√©ployer l'Edge Function
   ‚Üí Copier ai-answer/index.ts dans Supabase
   ‚Üí Ou utiliser: deploy-ai-function.bat/.sh

# 5. Tester !
   npm run dev
```

### 2. Documentation

üìñ **Guide complet** : [QUICK_START_AI_CHATBOT.md](./QUICK_START_AI_CHATBOT.md)

---

## üìÅ Structure du projet

```
SmartAppAcademy‚Ñ¢/
‚îÇ
‚îú‚îÄ‚îÄ supabase/
‚îÇ   ‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ai_chatbot.sql                  ‚Üê Base de donn√©es
‚îÇ   ‚îî‚îÄ‚îÄ functions/
‚îÇ       ‚îî‚îÄ‚îÄ ai-answer/
‚îÇ           ‚îî‚îÄ‚îÄ index.ts                     ‚Üê Edge Function
‚îÇ
‚îú‚îÄ‚îÄ client/src/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SmartAIAssistant.tsx            ‚Üê Interface utilisateur
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AIPromptManager.tsx             ‚Üê Interface admin
‚îÇ   ‚îî‚îÄ‚îÄ lib/
‚îÇ       ‚îî‚îÄ‚îÄ supabase.ts                      ‚Üê Fonctions helper
‚îÇ
‚îú‚îÄ‚îÄ deploy-ai-function.sh                    ‚Üê Script d√©ploiement (Mac/Linux)
‚îú‚îÄ‚îÄ deploy-ai-function.bat                   ‚Üê Script d√©ploiement (Windows)
‚îÇ
‚îî‚îÄ‚îÄ Documentation/
    ‚îú‚îÄ‚îÄ QUICK_START_AI_CHATBOT.md           ‚Üê Guide 5 min ‚≠ê
    ‚îú‚îÄ‚îÄ CHATBOT_IA_SETUP.md                 ‚Üê Guide complet
    ‚îú‚îÄ‚îÄ AI_CHATBOT_API.md                   ‚Üê R√©f√©rence API
    ‚îú‚îÄ‚îÄ CHATBOT_VISUAL_GUIDE.md             ‚Üê Guide visuel
    ‚îú‚îÄ‚îÄ CHATBOT_IA_RESUME.md                ‚Üê R√©capitulatif
    ‚îú‚îÄ‚îÄ CHATBOT_ONE_PAGE.md                 ‚Üê Vue d'ensemble (1 page)
    ‚îú‚îÄ‚îÄ INDEX_CHATBOT_IA.md                 ‚Üê Index navigation
    ‚îú‚îÄ‚îÄ CHANGELOG_CHATBOT_IA.md             ‚Üê Historique
    ‚îî‚îÄ‚îÄ CHATBOT_README.md                   ‚Üê Ce fichier
```

---

## üèóÔ∏è Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    FRONTEND (React)                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ        SmartAIAssistant Component               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Interface de chat                            ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Gestion des messages                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  ‚Ä¢ Appels API                                   ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ HTTPS POST + JWT
                      ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              SUPABASE EDGE FUNCTION                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ           ai-answer Function                    ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  1. ‚úÖ Authentification (JWT)                  ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  2. ‚úÖ R√©cup√©ration du prompt syst√®me          ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  3. ‚úÖ Chargement de l'historique              ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  4. ‚úÖ Appel OpenAI API                        ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  5. ‚úÖ Sauvegarde des messages                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ  6. ‚úÖ Retour de la r√©ponse                    ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ          ‚îÇ          ‚îÇ
      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      ‚îÇ OpenAI   ‚îÇ  ‚îÇ PostgreSQL ‚îÇ  ‚îÇ  Auth   ‚îÇ
      ‚îÇ   API    ‚îÇ  ‚îÇ  Database  ‚îÇ  ‚îÇ Service ‚îÇ
      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîê S√©curit√©

### ‚úÖ Mesures en place

- **Cl√© API prot√©g√©e** : Stock√©e c√¥t√© serveur, jamais expos√©e au client
- **Authentification requise** : JWT v√©rifi√© pour chaque requ√™te
- **RLS activ√©** : Row Level Security sur toutes les tables
- **Isolation des donn√©es** : Chaque utilisateur ne voit que ses conversations
- **CORS configur√©** : Protection contre les acc√®s non autoris√©s
- **Validation des entr√©es** : Toutes les donn√©es sont valid√©es

---

## üí∞ Co√ªts

### Mod√®le : gpt-4o-mini (ultra-√©conomique)

| Usage | Messages/jour | Co√ªt/mois |
|-------|---------------|-----------|
| L√©ger | 50 | ~0,75‚Ç¨ |
| Normal | 200 | ~3‚Ç¨ |
| Intensif | 1000 | ~15‚Ç¨ |

üí° **Note** : Nouveaux comptes OpenAI re√ßoivent des cr√©dits gratuits !

### D√©tails des tarifs
- **Input** : $0.15 / million de tokens (~750 000 mots)
- **Output** : $0.60 / million de tokens (~750 000 mots)
- **Conversations moyennes** : 150-300 tokens par √©change

---

## üé® Personnalisation

### Modifier le comportement de l'IA

#### Via l'interface admin (recommand√©)
1. Acc√©der √† l'Admin Dashboard
2. Section "Gestion du Prompt IA"
3. Modifier le texte du prompt
4. Enregistrer

#### Via SQL
```sql
UPDATE ai_system_prompts 
SET prompt = 'Votre nouveau prompt ici...'
WHERE is_active = true;
```

### Modifier les param√®tres OpenAI

Fichier : `supabase/functions/ai-answer/index.ts`

```typescript
// Ligne ~120
const openaiResponse = await fetch('https://api.openai.com/v1/chat/completions', {
  body: JSON.stringify({
    model: 'gpt-4o-mini',  // Mod√®le √† utiliser
    messages: messages,
    temperature: 0.7,       // Cr√©ativit√© (0-2)
    max_tokens: 1000,       // Longueur maximale de r√©ponse
  }),
})
```

---

## üìä Monitoring

### Dashboard Supabase

```
Dashboard > Edge Functions > ai-answer > Logs
‚Ä¢ Voir toutes les requ√™tes
‚Ä¢ Temps de r√©ponse
‚Ä¢ Erreurs √©ventuelles
‚Ä¢ Usage des tokens
```

### Requ√™tes SQL utiles

```sql
-- Nombre total de messages
SELECT COUNT(*) FROM messages;

-- Messages par jour
SELECT 
  DATE(created_at) as date,
  COUNT(*) as count
FROM messages
GROUP BY DATE(created_at)
ORDER BY date DESC;

-- Conversations actives
SELECT COUNT(*) FROM conversations
WHERE updated_at > NOW() - INTERVAL '7 days';

-- Utilisateurs les plus actifs
SELECT 
  user_id,
  COUNT(*) as message_count
FROM messages
WHERE role = 'user'
GROUP BY user_id
ORDER BY message_count DESC
LIMIT 10;
```

### OpenAI Usage
```
https://platform.openai.com/usage
‚Ä¢ Voir la consommation de tokens
‚Ä¢ Suivre les co√ªts
‚Ä¢ Analyser l'utilisation
```

---

## üîß API pour les d√©veloppeurs

### Fonctions disponibles

```typescript
import {
  sendAIMessage,
  getAIConversations,
  getAIMessages,
  deleteAIConversation,
  getActiveSystemPrompt,
  updateSystemPrompt
} from './lib/supabase'

// Envoyer un message
const result = await sendAIMessage("Bonjour !", conversationId?)
// ‚Üí { success, conversationId, answer, error? }

// R√©cup√©rer les conversations
const conversations = await getAIConversations()
// ‚Üí AIConversation[]

// R√©cup√©rer les messages d'une conversation
const messages = await getAIMessages(conversationId)
// ‚Üí AIMessage[]

// Supprimer une conversation
const success = await deleteAIConversation(conversationId)
// ‚Üí boolean

// R√©cup√©rer le prompt syst√®me actif
const prompt = await getActiveSystemPrompt()
// ‚Üí AISystemPrompt | null

// Mettre √† jour le prompt (admin)
const success = await updateSystemPrompt(promptId, newPrompt)
// ‚Üí boolean
```

üìñ **Documentation compl√®te** : [AI_CHATBOT_API.md](./AI_CHATBOT_API.md)

---

## üêõ D√©pannage

### Erreur "Non autoris√©" (401)
**Cause** : Utilisateur non connect√©  
**Solution** : V√©rifier `supabase.auth.getSession()`

### Erreur "OPENAI_API_KEY non configur√©e"
**Cause** : Secret manquant dans Supabase  
**Solution** : Configurer le secret via Dashboard ou CLI

### L'IA ne r√©pond pas
**Cause** : Erreur OpenAI ou Edge Function  
**Solution** :
1. V√©rifier la console du navigateur (F12)
2. V√©rifier les logs Supabase Dashboard
3. V√©rifier les cr√©dits OpenAI

### Erreur "Insufficient credits"
**Cause** : Cr√©dits OpenAI √©puis√©s  
**Solution** : Ajouter un moyen de paiement sur platform.openai.com

üìñ **Guide complet** : [CHATBOT_IA_SETUP.md](./CHATBOT_IA_SETUP.md) section "D√©pannage"

---

## üöÄ Roadmap

### Version 1.1.0 (Court terme)
- [ ] Interface de gestion des conversations
- [ ] Bouton "Nouvelle conversation"
- [ ] Export de conversations en PDF
- [ ] Statistiques d'utilisation dans l'admin

### Version 1.2.0 (Moyen terme)
- [ ] Recherche dans les conversations
- [ ] Tags et cat√©gories
- [ ] Partage de conversations
- [ ] Mode "expert" avec param√®tres ajustables

### Version 2.0.0 (Long terme)
- [ ] RAG avec documents utilisateur (pgvector)
- [ ] Int√©gration recherche web
- [ ] Support multi-mod√®les (GPT-4, Claude, Gemini)
- [ ] Assistant vocal (Whisper + TTS)
- [ ] Mode collaboratif

---

## üìö Documentation compl√®te

### Guides utilisateur
- üìò **[QUICK_START_AI_CHATBOT.md](./QUICK_START_AI_CHATBOT.md)** - D√©marrage rapide (5 min) ‚≠ê
- üìó **[CHATBOT_IA_SETUP.md](./CHATBOT_IA_SETUP.md)** - Guide complet
- üìô **[CHATBOT_VISUAL_GUIDE.md](./CHATBOT_VISUAL_GUIDE.md)** - Guide visuel
- üìï **[CHATBOT_ONE_PAGE.md](./CHATBOT_ONE_PAGE.md)** - Vue d'ensemble (1 page)

### Documentation technique
- üíª **[AI_CHATBOT_API.md](./AI_CHATBOT_API.md)** - R√©f√©rence API
- üîß **[supabase/functions/README.md](./supabase/functions/README.md)** - Edge Functions
- üìù **[CHANGELOG_CHATBOT_IA.md](./CHANGELOG_CHATBOT_IA.md)** - Historique

### Navigation
- üìë **[INDEX_CHATBOT_IA.md](./INDEX_CHATBOT_IA.md)** - Index complet
- üìÑ **[CHATBOT_README.md](./CHATBOT_README.md)** - Ce fichier

---

## ü§ù Contribution

Ce chatbot est d√©velopp√© pour SmartApp Academy‚Ñ¢. Pour toute suggestion ou am√©lioration :

1. Consultez le [CHANGELOG](./CHANGELOG_CHATBOT_IA.md)
2. V√©rifiez la [Roadmap](#üöÄ-roadmap)
3. Proposez vos id√©es

---

## üìÑ Licence

Propri√©t√© de SmartApp Academy‚Ñ¢ - Tous droits r√©serv√©s.

---

## üÜò Support

### Ressources
- üìñ [Documentation compl√®te](./INDEX_CHATBOT_IA.md)
- üêõ [Guide de d√©pannage](./CHATBOT_IA_SETUP.md#üêõ-d√©pannage)
- üíª [R√©f√©rence API](./AI_CHATBOT_API.md)

### Liens externes
- [OpenAI Documentation](https://platform.openai.com/docs)
- [Supabase Documentation](https://supabase.com/docs)
- [OpenAI Platform](https://platform.openai.com)
- [Supabase Dashboard](https://supabase.com/dashboard)

---

**üéâ Votre chatbot IA est pr√™t √† transformer l'exp√©rience utilisateur ! üéâ**

---

*Smart AI Assistant v1.0 - Octobre 2025*  
*Propuls√© par OpenAI (GPT-4o-mini) & Supabase*

